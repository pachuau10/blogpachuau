{% extends 'base.html' %}
{% load static %}

{% block title %} This is Category : {{category.title}} {% endblock title %}

{% block links %}
    <link rel="stylesheet" href="{% static 'css/css-reset.css' %}">
    <link rel="stylesheet" href="{% static 'css/normalize.css' %}">
    <link rel="stylesheet" href="{% static 'css/myCss-fm.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
{% endblock links %}

{% block content %}

{% include 'header.html' %}

<main class="flex-ctr-clm">
    <div class="container flex-ctr-str">
        
        <!-- Posts Section -->
        <div class="all-posts flex-ctr-clm">
            <h1>Category: {{category.title}}</h1>

            {% for post in posts %}
            <div class="post flex-ctr-str">

                <!-- Thumbnail -->
                <div class="thumbnail">
                    <a href="{% url 'post' post.slug %}">
                        <img src="{{post.thumbnail_img.url}}" alt="thumbnail of {{post.slug}}">
                    </a>
                </div>

                <!-- Post Content -->
                <div class="post-content flex-str-clm">

                    <h2 class="post-title">
                        <a href="{% url 'post' post.slug %}">{{post.title}}</a>
                    </h2>

                    <!-- Post date + categories inline -->
                    <div class="post-info flex-str-clm" style="align-items: flex-start;">
                        <span>{{ post.created_at|date:"M d, Y" }}</span>
                        <span class="categorie">
                            {% for categorie in post.categories.all %}
                                <a href="{% url 'category' categorie.slug %}">{{ categorie.title }}</a>{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                        </span>
                    </div>

                    <!-- Overview flush left -->
<div class="overview">{{ post.overview|truncatewords:50 }}</div>


                    <!-- Read More Button -->
                    <a href="{% url 'post' post.slug %}" class="read-more-btn">Read More <i class="fas fa-arrow-right"></i></a>

                </div>
            </div>
            {% empty %}
            <h2>No posts found in this category!</h2>
            {% endfor %}
        </div>

        <!-- Sidebar / Aside -->
        <aside class="aside flex-ctr-clm">
            <h2>Categories</h2>
            <div class="category-list">
                {% for cat in all_categories %}
                    <p><a href="{% url 'category' cat.slug %}">{{ cat.title }} ({{ cat.post_count }})</a></p>
                {% empty %}
                    <p>No categories found.</p>
                {% endfor %}
            </div>

            <h2>Recent Posts</h2>
            <div class="recent-posts">
                {% for recent in recent_posts %}
                    <p><a href="{% url 'post' recent.slug %}">{{ recent.title }}</a></p>
                {% empty %}
                    <p>No recent posts found.</p>
                {% endfor %}
            </div>


        </aside>

    </div>
</main>

{% include 'footer.html' %}

{% endblock content %}

{% block scripts %}
<script src="{% static 'js/script.js' %}"></script>
{% endblock scripts %}
